LAMMPS (29 Oct 2020)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:94)
  using 1 OpenMP thread(s) per MPI task
#-------------------------
#
#This script is used to create different concentrations of vacancies in thorium dioxide
#By Ziqiang Wang on 07/03/2023
#
#-------------------------

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:94)
  using 1 OpenMP thread(s) per MPI task
units                        metal
dimension                        3
boundary                     p p p
atom_style                   full
atom_modify                  map array

read_data                   perfect_relaxed.dat
Reading data file ...
  orthogonal box = (-0.27717828 -3.4472206 -0.27717828) to (27.617178 331.52722 27.617178)
  2 by 13 by 2 MPI processor grid
  reading atoms ...
  18000 atoms
  reading velocities ...
  18000 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0.0      0.0      0.0     
  special bond factors coul:  0.0      0.0      0.0     
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.004 seconds
  read_data CPU = 0.072 seconds

# randomly create vacancies in the relaxed perfect crystal
variable                   vac_ratio    equal  0.02
group                      Th_del    id  17546 17595 15604 15603 14511 14509  1550  5152  5761  5763 16130  1729                                              2127  5728   976   985  7924  4383 13874 13864 11785 11775 17738  3328                                              266  3925  1429  1372 14365 14355 12553 12484 17929 17870  9698  9700                                              10011 13552  5872  5870  3517 17907 16706 16755  8785  5187 11533  7935                                              15171   769 12877  9267  6398  6397 13960 13969 10561  6902 11989 11990                                              1960 16359  6469  6400  6266  6267 16838 16897 11355 11306 11449 11440                                              10130 13732 14404 14461  5401  5344  4741  4684 16058  1660 17703 17704                                              4552  4611 16178 16180 16792 16849  6746  6748  9447  9445 15073 11474                                              7526 11125  8197  8187 13635 13574 14894 14893 11341  7742  1731  1730                                              1324 15722  5822  5881  8497  8428  1563  5104 15758 15807 12194 12184
120 atoms in group Th_del

group                       O_delete    id  17541 17542 17539 17540 12006 12008 15547 15548 14455 14456 10848 10856                                              1545  1546  1554  1556  2108  2166  5707  5708 16125 16126 16068 16076                                              2071  2072  2130  2132 15378 15380 15324 15332  4326  4328  4327  4331                                              13869 13870 10266 10268  8124  8132 11719 11720 17733 17734 17730 17732                                              261   262   264   272 15768 15776 15774 15778 10704 10712 14299 14300                                              8892  8900  8886  8888 14268 14276 17865 17866  9693  9694  6102  6104                                              9955  9956  9954  9958  2274  2276  5865  5866 17856 17864 17851 17852                                              16701 16702 16699 16700  5124  5132  5131  5135  7872  7880  7879  7883                                              15115 15116 15108 15166  9216  9224  9211  9212  6393  6394  2736  2744                                              10362 10364 10308 10316  6908  6966  6905  6906  8328  8336 11985 11986                                              16362 16364 16303 16304  2808  2816  2802  2804  6261  6262  6211  6212                                              16833 16834 13236 13244 11299 11300 11301 11302  7788  7796  7842  7844                                              10125 10126 10134 10136 10806 10808 10866 14407  1748  1806  1746  1750                                              1088  1146  1086  1090 16053 16054 16062 16064 17647 17648 14106 14108                                              954   956  4555  4556 16173 16174 12582 12584 13194 13196 13188 13246                                              6741  6742  3150  3152  9391  9392  5784  5792 11412 11420 11469 11470                                              7521  7522  7464  7472  4536  4544  8131  8135 13579 13580 13569 13570                                              14889 14890 11232 11240  7740  7798  7797  7799  1675  1676  1725  1726                                              15726 15728 15725 15727  5825  5826  2228  2286  4836  4844  4830  4832                                              1507  1508  1506  1510 15753 15754 15751 15752 12189 12190  8586  8588
240 atoms in group O_delete

delete_atoms                group       O_delete
WARNING: Ignoring 'compress yes' for molecular system (../delete_atoms.cpp:125)
Deleted 240 atoms, new total = 17760
set                         group       Th_del     type   3
Setting atom values ...
  120 settings made for type

set                         type    1      charge   -1.1104
Setting atom values ...
  11760 settings made for charge
set                         type    2      charge    2.2208
Setting atom values ...
  5880 settings made for charge
set                         type    3      charge    0.0
Setting atom values ...
  120 settings made for charge
kspace_style                pppm     1.0e-05
pair_style                  hybrid/overlay  coul/long   11.0  eam/alloy  table  linear  1000  pppm
pair_coeff                  * * coul/long
pair_coeff                  * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th NULL
pair_coeff                  3 3 table CRG_gas_potentials.lmptab Xe-Xe 11
WARNING: 13 of 1000 force values in table Xe-Xe are inconsistent with -dE/dr.
  Should only be flagged at inflection points (../pair_table.cpp:461)
pair_coeff                  1 3 table CRG_gas_potentials.lmptab Xe-O 11
WARNING: 2 of 1000 force values in table Xe-O are inconsistent with -dE/dr.
  Should only be flagged at inflection points (../pair_table.cpp:461)
pair_coeff                  2 3 table CRG_gas_potentials.lmptab Xe-Th 11
WARNING: 2 of 1000 force values in table Xe-Th are inconsistent with -dE/dr.
  Should only be flagged at inflection points (../pair_table.cpp:461)
neighbor                    2.0  bin
neigh_modify                every  1  delay  0  check  yes

# fully relaxing the defect configuration at 0K
fix                box_relax  all  box/relax aniso 0.0 vmax 0.001
min_style          cg
minimize           1.0e-30 1.0e-30 10000 10000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:328)
  G vector (1/distance) = 0.29911239
  grid = 40 240 40
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00015328544
  estimated relative force accuracy = 1.0645085e-05
  using single precision MKL FFT
  3d grid and FFT values/proc = 18225 7600
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  binsize = 6.5, bins = 5 52 5
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) pair eam/alloy, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (3) pair table, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 10.36 | 11.00 | 11.16 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            0   -229632.63            0   -229632.63    9140.4523    260641.98 
     100            0   -230941.74            0   -230941.74    336.88463    262697.78 
Loop time of 1.99299 on 52 procs for 100 steps with 17760 atoms

99.1% CPU use with 52 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -229632.634921285  -230941.737745532  -230941.737745879
  Force two-norm initial, final = 2606.0862 106.05424
  Force max component initial, final = 1672.1886 72.647109
  Final line search alpha, max atom move = 6.9586315e-13 5.0552446e-11
  Iterations, force evaluations = 100 179

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.1579     | 1.2092     | 1.2515     |   1.9 | 60.67
Bond    | 1.8625e-05 | 2.5659e-05 | 4.0204e-05 |   0.0 |  0.00
Kspace  | 0.3198     | 0.36228    | 0.41707    |   3.6 | 18.18
Neigh   | 0.013825   | 0.016557   | 0.019011   |   0.8 |  0.83
Comm    | 0.030732   | 0.032472   | 0.034863   |   0.5 |  1.63
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.3725     |            |       | 18.69

Nlocal:        341.538 ave         389 max         297 min
Histogram: 1 4 3 7 13 10 8 2 2 2
Nghost:        5546.12 ave        5664 max        5433 min
Histogram: 5 9 5 4 3 3 4 5 11 3
Neighs:       108620.0 ave      123516 max       94138 min
Histogram: 1 3 4 7 15 9 6 4 0 3

Total # of neighbors = 5648223
Ave neighs/atom = 318.03057
Ave special neighs/atom = 0.0000000
Neighbor list builds = 5
Dangerous builds = 0
unfix              box_relax

# apply the temperature into the system and relaxing at the temperature of interest
reset_atom_ids
Resetting atom IDs ...
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:328)
  G vector (1/distance) = 0.29897673
  grid = 40 240 40
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00015432844
  estimated relative force accuracy = 1.0717517e-05
  using single precision MKL FFT
  3d grid and FFT values/proc = 18225 7600
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  binsize = 6.5, bins = 5 52 5
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) pair eam/alloy, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (3) pair table, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0.0      0.0      0.0     
  special bond factors coul:  0.0      0.0      0.0     
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
variable                    temp      equal    600
velocity                    all  create   ${temp}  4542  dist  gaussian  rot  yes  mom  yes
velocity                    all  create   600  4542  dist  gaussian  rot  yes  mom  yes
fix                         npt  all  npt  temp  ${temp}  ${temp}  $(100*dt) aniso  0.0  0.0  $(1000*dt)
fix                         npt  all  npt  temp  600  ${temp}  $(100*dt) aniso  0.0  0.0  $(1000*dt)
fix                         npt  all  npt  temp  600  600  $(100*dt) aniso  0.0  0.0  $(1000*dt)
fix                         npt  all  npt  temp  600  600  0.10000000000000000555 aniso  0.0  0.0  $(1000*dt)
fix                         npt  all  npt  temp  600  600  0.10000000000000000555 aniso  0.0  0.0  1

thermo                      20000
thermo_style                custom   step dt time atoms temp pe ke press vol

shell                       mkdir vac_${vac_ratio}_${temp}K
shell                       mkdir vac_0.02_${temp}K
shell                       mkdir vac_0.02_600K
dump                        1  all  custom  20000  ./vac_${vac_ratio}_${temp}K/dump_relax.atom.* id type q x y z
dump                        1  all  custom  20000  ./vac_0.02_${temp}K/dump_relax.atom.* id type q x y z
dump                        1  all  custom  20000  ./vac_0.02_600K/dump_relax.atom.* id type q x y z
dump_modify                 1  element  O  Th  Xe

run                         100000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:328)
  G vector (1/distance) = 0.29897673
  grid = 40 240 40
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00015432844
  estimated relative force accuracy = 1.0717517e-05
  using single precision MKL FFT
  3d grid and FFT values/proc = 18225 7600
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  binsize = 6.5, bins = 5 52 5
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) pair eam/alloy, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (3) pair table, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 9.234 | 9.989 | 10.03 Mbytes
Step Dt Time Atoms Temp PotEng KinEng Press Volume 
     100        0.001            0    17760          600   -230941.74    1377.3185      5936.72    262697.78 
   20000        0.001         19.9    17760     594.2285   -229814.59    1364.0699    279.59256     267192.5 
   40000        0.001         39.9    17760    599.29319   -229867.22     1375.696    362.03791    267077.27 
   60000        0.001         59.9    17760    595.25696   -229856.64    1366.4307   -1725.7022    267421.86 
   80000        0.001         79.9    17760    596.21052   -229866.63    1368.6197      64.0411    267116.08 
  100000        0.001         99.9    17760    604.06391   -229866.77    1386.6474   -830.94321    267250.37 
  100100        0.001          100    17760    603.55915   -229857.44    1385.4887    624.35035    267003.93 
Loop time of 826.86 on 52 procs for 100000 steps with 17760 atoms

Performance: 10.449 ns/day, 2.297 hours/ns, 120.940 timesteps/s
99.8% CPU use with 52 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 521.71     | 536.3      | 549.75     |  26.4 | 64.86
Bond    | 0.010684   | 0.016571   | 0.025077   |   2.5 |  0.00
Kspace  | 153.37     | 167.09     | 181.83     |  48.1 | 20.21
Neigh   | 2.9919     | 3.1653     | 3.367      |   5.0 |  0.38
Comm    | 16.115     | 16.497     | 16.943     |   5.5 |  2.00
Output  | 0.025515   | 0.025539   | 0.026541   |   0.1 |  0.00
Modify  | 92.707     | 96.061     | 100.08     |  21.5 | 11.62
Other   |            | 7.705      |            |       |  0.93

Nlocal:        341.538 ave         363 max         320 min
Histogram: 1 3 6 11 11 5 3 3 3 6
Nghost:        5525.69 ave        5656 max        5379 min
Histogram: 4 2 7 10 3 3 4 8 6 5
Neighs:       106828.0 ave      114660 max       98587 min
Histogram: 1 5 6 11 3 8 4 6 2 6

Total # of neighbors = 5555081
Ave neighs/atom = 312.78609
Ave special neighs/atom = 0.0000000
Neighbor list builds = 1002
Dangerous builds = 0
shell                       mkdir thermal_condu
write_data                  thermal_condu/vac_${vac_ratio}_relaxed.dat
write_data                  thermal_condu/vac_0.02_relaxed.dat
System init for write_data ...
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:328)
  G vector (1/distance) = 0.29867874
  grid = 40 240 40
  stencil order = 5
  estimated absolute RMS force accuracy = 0.00015671702
  estimated relative force accuracy = 1.0883395e-05
  using single precision MKL FFT
  3d grid and FFT values/proc = 18225 7600
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 13
  ghost atom cutoff = 13
  binsize = 6.5, bins = 5 52 5
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) pair eam/alloy, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (3) pair table, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
Total wall time: 0:13:49
